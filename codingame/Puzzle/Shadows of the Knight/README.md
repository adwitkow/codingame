https://www.codingame.com/ide/puzzle/shadows-of-the-knight-episode-1

This solution is not exactly elegant, but it works well and handles huge maps in reasonable time per action.